!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("@firestitch/api",[],t):"object"==typeof exports?exports["@firestitch/api"]=t():e["@firestitch/api"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s="./index.ts")}({"./fsapi.module.ts":function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};Object.defineProperty(t,"__esModule",{value:!0});var o=n("@firestitch/common"),i=n("@angular/common/http"),s=n("./fsapi.service.ts"),c=n("@angular/core"),a=n("@angular/common");!function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n("./fsapi.service.ts"));var u=function(){function e(){}return t=e,e.forRoot=function(){return{ngModule:t,providers:[s.FsApiConfig,s.FsApi]}},e=t=r([c.NgModule({imports:[a.CommonModule,i.HttpClientModule],declarations:[],providers:[o.FsUtil,s.FsApi,s.FsApiConfig],exports:[]})],e);var t}();t.FsApiModule=u},"./fsapi.service.ts":function(e,t,n){"use strict";var r=this&&this.__decorate||function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},o=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},i=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}};Object.defineProperty(t,"__esModule",{value:!0});var s=n("@angular/core"),c=n("@firestitch/common"),a=n("rxjs/Observable"),u=n("@angular/common/http"),p=n("moment-timezone"),f=function(){function e(e){this.config=e,this.headers={},this.encoding="json",this.key=null,this.query={},Object.assign(this,e||{})}return e.prototype.appendHeader=function(e,t){this.headers[e]=t},e=r([s.Injectable(),i(0,s.Optional()),i(0,s.Inject("FsApiConfig")),o("design:paramtypes",[Object])],e)}();t.FsApiConfig=f;var l=function(){function e(e,t,n){this.FsApiConfig=e,this.FsUtil=t,this.http=n,this.events=[]}return e.prototype.get=function(e,t,n){return this.request("GET",e,t,n)},e.prototype.post=function(e,t,n){return this.request("POST",e,t,n)},e.prototype.put=function(e,t,n){return this.request("PUT",e,t,n)},e.prototype.delete=function(e,t,n){return this.request("DELETE",e,t,n)},e.prototype.request=function(e,t,n,r){var o=this;r=Object.assign({},this.FsApiConfig,r),e=e.toUpperCase(),n=Object.assign({},n),this.sanitize(n),"GET"===e&&(r.query=n,n={});var i=new u.HttpHeaders;this.FsUtil.each(r.headers,function(e,t){i=i.set(t,e)});var s=!1;this.FsUtil.each(n,function(e){(e instanceof File||e instanceof Blob)&&(s=!0,r.encoding="formdata")});var c=null;"url"===r.encoding?(i=i.set("Content-Type","application/x-www-form-urlencoded"),c=n):"json"===r.encoding?(i=i.set("Content-Type","text/json"),c=JSON.stringify(n)):"formdata"===r.encoding&&(i=i.delete("Content-Type"),c=new FormData,this.FsUtil.each(n,function(e,t){null!=e&&e.name?c.append(t,e,e.name):c.append(t,e)}));var p=new u.HttpParams;this.FsUtil.each(r.query,function(e,t){p=p.append(t,e)});var f=new u.HttpRequest(e,t,c,{headers:i,params:p});return this.trigger("begin",f,r),a.Observable.create(function(e){o.intercept(r,f,new d(o.http)).subscribe(function(t){if(t.type!==u.HttpEventType.Sent&&t.type!==u.HttpEventType.ResponseHeader)if(t.type!==u.HttpEventType.DownloadProgress)t.type===u.HttpEventType.Response&&(o.trigger("success",t,r),e.next(t.body));else{Math.round(t.loaded/1024)}},function(t){o.trigger("error",event,r),e.error(t)},function(){o.trigger("complete",null,r),e.complete()})})},e.prototype.on=function(e,t){return this.events.push({name:e,func:t}),this},e.prototype.trigger=function(e,t,n){return this.FsUtil.each(this.events,function(r){e===r.name&&r.func(t,n)}),this},e.prototype.intercept=function(e,t,n){return n.handle(t)},e.prototype.sanitize=function(e){var t=this;return this.FsUtil.each(e,function(n,r){p&&p.isMoment(n)?e[r]=n.format():n instanceof Date?e[r]=p(n).format():void 0===n?delete e[r]:t.FsUtil.isObject(n)&&t.sanitize(n)}),e},e=r([s.Injectable(),o("design:paramtypes",[f,c.FsUtil,u.HttpClient])],e)}();t.FsApi=l;var d=function(){function e(e){this.http=e}return e.prototype.handle=function(e){return console.log("FsApiHandler",e),this.http.request(e)},e}();t.FsApiHandler=d},"./index.ts":function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n("./fsapi.module.ts")),r(n("./fsapi.service.ts"))},"@angular/common":function(e,t){e.exports=require("@angular/common")},"@angular/common/http":function(e,t){e.exports=require("@angular/common/http")},"@angular/core":function(e,t){e.exports=require("@angular/core")},"@firestitch/common":function(e,t){e.exports=require("@firestitch/common")},"moment-timezone":function(e,t){e.exports=require("moment-timezone")},"rxjs/Observable":function(e,t){e.exports=require("rxjs/Observable")}})});